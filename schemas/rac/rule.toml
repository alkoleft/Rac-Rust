[record.RuleRecord]
derive = ["Debug", "Serialize", "Clone"]
fields = [
  { name = "rule", type = "uuid" },
  { name = "object_type", type = "u32_be" },
  { name = "infobase_name", type = "str8" },
  { name = "rule_type", type = "u8" },
  { name = "application_ext", type = "str8" },
  { name = "priority", type = "u32_be" },
]

[record.RuleIdRecord]
derive = ["Debug", "Serialize", "Clone"]
fields = [
  { name = "rule", type = "uuid" },
]

[request.RuleListRequest]
derive = ["Debug", "Clone"]
fields = [
  { name = "cluster", type = "uuid" },
  { name = "server", type = "uuid" },
]

[request.RuleInfoRequest]
derive = ["Debug", "Clone"]
fields = [
  { name = "cluster", type = "uuid" },
  { name = "server", type = "uuid" },
  { name = "rule", type = "uuid" },
]

[request.RuleApplyRequest]
derive = ["Debug", "Clone"]
fields = [
  { name = "cluster", type = "uuid" },
  { name = "mode", type = "u32_be" },
]

[request.RuleRemoveRequest]
derive = ["Debug", "Clone"]
fields = [
  { name = "cluster", type = "uuid" },
  { name = "server", type = "uuid" },
  { name = "rule", type = "uuid" },
]

[request.RuleInsertRequest]
derive = ["Debug", "Clone"]
fields = [
  { name = "cluster", type = "uuid" },
  { name = "server", type = "uuid" },
  { name = "padding", type = "bytes_fixed", literal = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], len = 16 },
  { name = "position", type = "u32_be" },
  { name = "object_type", type = "u32_be" },
  { name = "infobase_name", type = "str8" },
  { name = "rule_type", type = "u8" },
  { name = "application_ext", type = "str8" },
  { name = "priority", type = "u32_be" },
]

[request.RuleUpdateRequest]
derive = ["Debug", "Clone"]
fields = [
  { name = "cluster", type = "uuid" },
  { name = "server", type = "uuid" },
  { name = "rule", type = "uuid" },
  { name = "position", type = "u32_be" },
  { name = "object_type", type = "u32_be" },
  { name = "infobase_name", type = "str8" },
  { name = "rule_type", type = "u8" },
  { name = "application_ext", type = "str8" },
  { name = "priority", type = "u32_be" },
]

[rpc.RuleList]
request = "RuleListRequest"
method_req = 0x55
method_resp = 0x56
requires_cluster_context = true
requires_infobase_context = false

[rpc.RuleInfo]
request = "RuleInfoRequest"
method_req = 0x57
method_resp = 0x58
requires_cluster_context = true
requires_infobase_context = false

[rpc.RuleApply]
request = "RuleApplyRequest"
method_req = 0x51
requires_cluster_context = true
requires_infobase_context = false

[rpc.RuleRemove]
request = "RuleRemoveRequest"
method_req = 0x54
requires_cluster_context = true
requires_infobase_context = false

[rpc.RuleInsert]
request = "RuleInsertRequest"
method_req = 0x52
method_resp = 0x53
requires_cluster_context = true
requires_infobase_context = false

[rpc.RuleUpdate]
request = "RuleUpdateRequest"
method_req = 0x52
method_resp = 0x53
requires_cluster_context = true
requires_infobase_context = false

[response.RuleList]
body = { type = "list_u8", item = "RuleRecord" }

[response.RuleInfo]
body = { type = "record", item = "RuleRecord" }

[response.RuleInsert]
body = { type = "record", item = "RuleIdRecord" }

[response.RuleUpdate]
body = { type = "record", item = "RuleIdRecord" }
